"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var DOMTraverse={articleWrapper:document.querySelector(".article-wrapper"),mainMenu:document.getElementById("main-menu"),mainTag:document.querySelector("main"),sectionTitles:document.getElementsByClassName("section-title"),allStoriesButton:document.getElementById("show-all-stories"),searchform:document.getElementById("search-form"),searchInput:document.getElementById("search-for-title"),topSpan:document.getElementsByClassName("top-span")[0],storyLoader:document.getElementsByClassName("story-loader"),loginForm:document.getElementById("login-form"),resetForm:document.getElementById("reset-form"),signUpForm:document.getElementById("sign-up-form"),signUpBirthday:document.getElementById("sign-up-birthday"),tovalidate:[].concat(_toConsumableArray(document.getElementsByClassName("validateJS")))},Utility={currentPath:window.location.pathname,getCurrentPath:function(){return"/index.html"==this.currentPath||"/"==this.currentPath?"index":"/html/search-results.html"==this.currentPath?"searchResults":"/html/signup.html"==this.currentPath?"signUp":"/html/stories/kater.html"==this.currentPath?"kater":"/html/stories/paranoia.html"==this.currentPath?"paranoia":"/html/stories/vrijdag-de-dertiende.html"==this.currentPath?"vrijdag":void 0},getCurrentScreenHeight:window.innerHeight,getCurrentScreenWidth:window.innerWidth,route:function(e,t){localStorage.setItem(e,t),window.location.href="/html/search-results.html"},storyStorage:"https://api.myjson.com/bins/zbwpn",xhr:new XMLHttpRequest},LoadStories={createRequest:function(e){function t(e){var t=document.createElement("span");t.innerText="Oeps, er ging iets fout. Probeer de pagina opnieuw te laden om de fout op te lossen!",DOMTraverse.articleWrapper.appendChild(t)}var n=Utility.xhr;n.open("GET",Utility.storyStorage,!0);var i=void 0;n.onprogress=function(){void 0==i&&(LoadStories.createLoader(DOMTraverse.articleWrapper),i=!0)},n.onload=function(){if(200==this.status){var t=JSON.parse(this.responseText);LoadStories.createArticles(t,e)}},n.onerror=function(e){t()},n.send()},createLoader:function(e){for(var t=document.createElement("ul"),n=0;n<12;n++){var i=document.createElement("li");t.appendChild(i)}t.classList.add("story-loader"),e.appendChild(t)},createArticles:function(e,t){function n(){var n=[];return"input"==t?(r=localStorage.getItem(t),e.stories.forEach(function(e){"allStories"===r?n.push(e.title):(e.title.toLowerCase().includes(r.toLowerCase())||-1!=e.text.indexOf(r.toLowerCase()))&&n.push(e.title)})):"readingList"==t&&(r=[].concat(_toConsumableArray(localStorage.getItem(t).split(",")))).forEach(function(e){n.push(e)}),n}function i(t){if(0==a)t.forEach(function(t,n){e.stories.forEach(function(e){return LoadStories.matchStorageToRequest(t,e,n)})}),a++;else if(1==a){var n=25;t.forEach(function(t){n++,console.log(n),e.stories.forEach(function(e){return LoadStories.matchStorageToRequest(t,e,n)})}),a++}else if(2==a){var i=50;t.forEach(function(t){i++,console.log(i),e.stories.forEach(function(e){return LoadStories.matchStorageToRequest(t,e,i)})}),a++}else if(3==a){var r=75;t.forEach(function(t){r++,console.log(r),e.stories.forEach(function(e){return LoadStories.matchStorageToRequest(t,e,r)})})}}var r=void 0,a=0;!function(){var e=n();if(0==e.length||void 0==e){LoadStories.hideSortButton();var a=document.createElement("span");a.innerHTML="Helaas, er zijn geen matches gevonden met de opgegeven input: "+r+".<br>Probeer een ander zoekwoord, of gebruik de filters om te zoeken.",DOMTraverse.articleWrapper.style.backgroundColor="white",DOMTraverse.articleWrapper.appendChild(a)}else if(e.length>25){var s=0;0==s&&i(e.slice(0,25)),"readingList"==t&&DOMTraverse.articleWrapper.classList.add("reading-list-js-results"),function(){if(Utility.getCurrentScreenWidth>1039){var t=DOMTraverse.articleWrapper.clientHeight;window.addEventListener("scroll",function(){if(window.pageYOffset>t-1500)if(0==s){var n=e.slice(25,50);t+=t,s++,i(n)}else if(1==s){var r=e.slice(50,75);t+=6e3,s++,i(r)}else if(2==s){var a=e.slice(75,100);t+=t,s++,i(a)}})}else{var n=DOMTraverse.articleWrapper.scrollWidth;DOMTraverse.articleWrapper.addEventListener("scroll",function(){if(DOMTraverse.articleWrapper.scrollLeft>n-1500)if(0==s){var t=e.slice(25,50);n+=n,s++,i(t)}else if(1==s){var r=e.slice(50,75);n+=6e3,s++,i(r)}else if(2==s){var a=e.slice(75,100);n+=n,s++,i(a)}})}}()}else"readingList"==t&&DOMTraverse.articleWrapper.parentElement.classList.add("reading-list-js-results"),i(e);[].concat(_toConsumableArray(DOMTraverse.sectionTitles)).forEach(function(t){"Resultaten"!=t.innerHTML&&"Leeslijst"!=t.innerHTML||(t.innerHTML+=" - "+e.length)})}(),DOMTraverse.articleWrapper.removeChild(DOMTraverse.storyLoader[0])},hideSortButton:function(){document.getElementById("toggle-button-group-sort").style.display="none"},matchStorageToRequest:function(e,t,n){if(e==t.title.toLowerCase()||e==t.title){var i=void 0;null!=t.image||void 0!=t.image?i="/dist/img/storyImages/"+t.image:void 0==t.image&&(i="http://lorempixel.com/400/200/");var r=t.title.toLowerCase(),a=t.nr,s=t.by,o=t.text.substr(0,150),l=o=t.text.substr(0,Math.min(o.length,o.lastIndexOf(" "))),c=t.text.substring(Math.max(o.length,o.lastIndexOf(" ")));DOMTraverse.articleWrapper.innerHTML+=CreateArticle.Article(i,s,r,a,l,c,n)}}},CreateArticle={Article:function(e,t,n,i,r,a,s){return'\n        <article id="'+n+'">\n            '+this.ArticleHeader(e,t,n,i,s)+"\n            "+this.Paragraph(s,r,a)+"\n            "+this.Footer(n)+"\n         </article>\n        "},ArticleHeader:function(e,t,n,i,r){return'\n            <header class="article-header">\n                <img src='+e+' alt="search-result-image" onclick="Microinteractions.toggleJavascript.call(this)" class="toggleFullStory" data-target="rest-text-'+r+'">\n                <span>Door: '+t+'</span>\n                <div><h3 onclick="Microinteractions.toggleJavascript.call(this)" class="toggleFullStory" data-target="rest-text-'+r+'">'+n+" ("+i+")</h3></div>\n            </header>\n        "},Paragraph:function(e,t,n){return'\n            <p onclick="Microinteractions.toggleJavascript.call(this)" aria-label="Open volledig verhaal" id="article-text-'+e+'" data-target="rest-text-'+e+'">\n                '+t+'\n                <span id="rest-text-'+e+'">'+n+"</span>\n            </p>\n        "},Footer:function(e){return"/"==Utility.currentPath?'\n                <footer>\n                    <button type="button" class="btn btn-main" onClick="IndexPage.removeFromList.call(this)" id=read-later-'+e+'>Verwijderen uit leeslijst</button>\n                    <button type="button" class="btn btn-main">Downloaden</button>\n                </footer>\n            ':'\n                <footer>\n                    <button type="button" class="btn btn-main" onClick="ResultPage.addActiveClass.call(this)" id=read-later-'+e+'>Toevoegen aan leeslijst</button>\n                    <button type="button" class="btn btn-main">Downloaden</button>\n                </footer>\n            '}},Microinteractions={toggleJavascript:function(){document.getElementById(""+this.dataset.target).classList.toggle("js-active"),Microinteractions.determineElClicked.call(this)},determineElClicked:function(){function e(e){return"/"==Utility.currentPath?"./dist/img/icons/"+e+".svg":Utility.currentPath.includes("stories")?"../../dist/img/icons/"+e+".svg":"../dist/img/icons/"+e+".svg"}var t=this.dataset.target;if(t.includes("main-menu"))"Account icon"==this.firstElementChild.alt?(DOMTraverse.mainTag.classList.add("js-active"),this.firstElementChild.alt="Sluit icon",this.firstElementChild.src=e("multiply"),this.setAttribute("aria-label","Sluit hoofdmenu")):(DOMTraverse.mainTag.classList.remove("js-active"),this.firstElementChild.alt="Account icon",this.firstElementChild.src=e("account"),this.setAttribute("aria-label","Open hoofdmenu"));else if(t.includes("result-page-search-form"));else if(t.includes("rest-text")&&this.classList.contains("toggleFullStory")){var n=function(){var e=this.getAttribute("data-target"),t=e.slice(e.lastIndexOf("-")+1);return document.getElementById("article-text-"+t)}.call(this);n.classList.contains("js-active")?(n.setAttribute("aria-label","Open volledig verhaal"),n.classList.remove("js-active")):(n.setAttribute("aria-label","Sluit volledig verhaal"),n.classList.add("js-active"))}else t.includes("rest-text")?this.classList.contains("js-active")?(this.setAttribute("aria-label","Open volledig verhaal"),this.classList.remove("js-active")):(this.setAttribute("aria-label","Sluit volledig verhaal"),this.classList.add("js-active")):t.includes("button-group-sort")?this.parentElement.classList.toggle("js-active"):this.classList.toggle("js-active")},loopOverDataTargets:void[].concat(_toConsumableArray(document.querySelectorAll("[data-target]"))).forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),Microinteractions.toggleJavascript.call(this)})})},Navigation={getLoginOrSignup:function(e){null!=window.localStorage.getItem("login")||null!=window.localStorage.getItem("signUp")?"index"==e?this.changeLoginNode("Uitloggen",!0,!0):"searchResults"==e&&this.changeLoginNode("Uitloggen",!0,!1):this.changeLoginNode("Inloggen")},changeLoginNode:function(e,t,n){var i=this.getNodes();i.loginNodeAnchor.innerText=e,!0===t&&!0===n?i.firstLoginSibling.insertAdjacentHTML("beforeBegin",'\n                    <li class="dynamic-js">\n                        <a href="./html/settings.html" role="menuitem">Accountinstellingen</a>\n                    </li>\n                    <li class="dynamic-js">\n                        <a href="./html/reading-history.html" role="menuitem">Leesgeschiedenis</a>\n                    </li>\n                    <li class="dynamic-js">\n                        <a href="#reading-list" role="menuitem">Leeslijst</a>\n                    </li>\n                    <li class="dynamic-js">\n                        <a href="./html/notifications.html" role="menuitem">Notificaties</a>\n                    </li>\n                '):!0===t&&!0!==n?i.firstLoginSibling.insertAdjacentHTML("beforeBegin",'\n                    <li class="dynamic-js">\n                        <a href="settings.html" role="menuitem">Accountinstellingen</a>\n                    </li>\n                    <li class="dynamic-js">\n                        <a href="reading-history.html" role="menuitem">Leesgeschiedenis</a>\n                    </li>\n                    <li class="dynamic-js">\n                        <a href="../index.html#reading-list" role="menuitem">Leeslijst</a>\n                    </li>\n                    <li class="dynamic-js">\n                        <a href="notifications.html" role="menuitem">Notificaties</a>\n                    </li>\n                '):this.removeAddedMenuItems()},getNodes:function(){var e=DOMTraverse.mainMenu.querySelector("#login-node");return{loginNode:e,menuList:e.parentElement,loginNodeAnchor:e.firstElementChild,firstLoginSibling:e.nextElementSibling}},removeAddedMenuItems:function(){var e=this.getNodes(),t=[].concat(_toConsumableArray(e.menuList.querySelectorAll(".dynamic-js")));t.forEach(function(e,n){t.splice(n,1)})}},IndexPage={setFormListeners:function(){DOMTraverse.searchform.addEventListener("submit",function(e){e.preventDefault();var t=DOMTraverse.searchInput.value;this.reset(),Utility.route("input",t)}),DOMTraverse.allStoriesButton.addEventListener("click",function(){return Utility.route("input","allStories")})},removeFromList:function(){[].concat(_toConsumableArray(window.localStorage.readingList.split(",")))},getReadingList:function(e){if(null!=window.localStorage.getItem("login")||null!=window.localStorage.getItem("signUp")){var t=localStorage.getItem("readingList");if(null===t||0==t.length)LoadStories.hideSortButton(),this.readingListNotFound();else{var n=DOMTraverse.articleWrapper.classList;n.contains("no-results")&&n.remove("no-results"),LoadStories.createRequest(e)}}else{var i=document.createElement("span");i.innerHTML="Om je leeslijst te zien, moet je ingelogd zijn. <a href='/html/signup.html'>U kunt zich hier inloggen</a>.",LoadStories.hideSortButton(),DOMTraverse.articleWrapper.parentElement.classList.add("reading-list-js-no-login"),DOMTraverse.articleWrapper.appendChild(i)}},readingListNotFound:function(){var e=DOMTraverse.articleWrapper,t=document.createElement("i"),n=document.createElement("span");t.setAttribute("aria-label","Leeslijst icon"),n.innerHTML="Er zijn geen verhalen gevonden in uw leeslijst.<br><a href='#search-form'>Ga op zoek naar nieuwe ervaringen!</a>",e.classList.add("no-results"),e.appendChild(t),e.appendChild(n)}},SignUpPage={Constraint:{getDate:function(){function e(e){return e<10?e="0"+e:e}var t=new Date,n=t.getDate(),i=t.getMonth()+1,r=t.getFullYear();return t=e(n)+"/"+e(i)+"/"+r},setCurrentDate:function(){var e=this.getDate();DOMTraverse.signUpBirthday.setAttribute("max",e)},getConstraints:function(){return{email:["[a-z0-9._%+-]+@[a-z0-9.-]+.[a-z]{2,3}$","Een email bestaat uit letters en nummers, een @ en minstens één punt"],name:["^[a-zA-Z]+(([',. -][a-zA-Z ])?[a-zA-Z]*)*$","Een volledige naam bestaat uit enkel woorden en spaties."],password:["^([a-zA-Z0-9@*#]{8,15})$","Een goed wachtwoord bestaat uit minimaal 8 tekens, waarvan minstens één hoofd- en kleine letter en een nummer."]}},matchConstraintToInputField:function(e,t){var n=this.getConstraints(),i=!0,r=!1,a=void 0;try{for(var s,o=Object.keys(n)[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){var l=s.value;e.includes(l)&&this.createConstraint(n,l,t)}}catch(e){r=!0,a=e}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}},createConstraint:function(e,t,n){var i=new RegExp(e[t][0]);0===n.value.length?n.classList.remove("js-active"):n.classList.add("js-active"),i.test(n.value)?n.setCustomValidity(""):n.setCustomValidity(e[t][1])},checkElements:function(){var e=this;DOMTraverse.tovalidate.forEach(function(t){t.addEventListener("keyup",function(){t.classList.contains("password")?e.matchConstraintToInputField("password",t):t.classList.contains("email")?e.matchConstraintToInputField("email",t):t.classList.contains("name")&&e.matchConstraintToInputField("name",t)})})}},UserActions:{userLogin:function(){function e(e){localStorage.setItem("login",JSON.stringify(e)),window.location.href="/index.html"}DOMTraverse.loginForm.addEventListener("submit",function(t){t.preventDefault(),e({email:this.querySelector("#login-email").value,password:this.querySelector("#login-password").value})})},userPasswordReset:function(){function e(e){localStorage.setItem("reset",e)}DOMTraverse.resetForm.addEventListener("submit",function(t){t.preventDefault(),e(this.querySelector("#reset-password").value)})},userSignUp:function(){function e(e){localStorage.setItem("signUp",JSON.stringify(e)),window.location.href="/index.html"}DOMTraverse.signUpForm.addEventListener("submit",function(t){t.preventDefault(),e({birthday:this.querySelector("#sign-up-birthday").value,email:this.querySelector("#sign-up-email").value,name:this.querySelector("#sign-up-name").value,nationality:this.querySelector("#sign-up-nationality").value,password:this.querySelector("#sign-up-password").value})})},init:function(){this.userLogin(),this.userPasswordReset(),this.userSignUp()}}},ResultPage={readingListArray:[],addActiveClass:function(){var e=this;this.classList.toggle("js-active"),setTimeout(function(){ResultPage.addToReadingList.call(e),ResultPage.showTopMessage.call(e)},1500)},addToReadingList:function(){var e=this.id.slice(this.id.lastIndexOf("-")+1);window.localStorage.getItem("readingList");ResultPage.readingListArray.push(e),window.localStorage.setItem("readingList",ResultPage.readingListArray)},showTopMessage:function(){var e=this;DOMTraverse.topSpan.classList.add("js-active"),setTimeout(function(){e.classList.remove("js-active"),DOMTraverse.topSpan.classList.remove("js-active")},3e3)}},StoryPage={Kater:{getElements:function(){var e=document.getElementsByClassName("story-1")[0],t=e.firstElementChild,n=t.querySelectorAll("section"),i=t.querySelector(".title");return{allSections:n,article:t,kater:e,paragraph:t.querySelector("p"),titleSection:i}},getTranslateValue:function(e){var t=e.indexOf("("),n=e.indexOf("%");return parseInt(e.slice(t+1,n-1))},handleScroll:function(){function e(e){i.scrollTop>=i.scrollHeight/e?!0===s?(a.style.transform="translateY(700%)",StoryPage.Kater.getTranslateValue(r.style.transform)<=5&&(r.style.transform="translateX(0%)")):(r.style.transform="translateX("+(i.scrollHeight/(e-1)-i.scrollTop)+"%)",setTimeout(function(){s=!0},500)):n.forEach(function(t,n){t.style.transform="skew("+(Math.floor(10*Math.random())+5)+"deg, "+(Math.floor(10*Math.random())+5)+"deg) rotate("+(Math.floor(10*Math.random())+5)+"deg) scale("+(Math.random()+.5)+") translateY(-"+i.scrollTop*e+"px) translateX("+i.scrollTop*e+"px)"})}var t=this.getElements(),n=t.allSections,i=t.kater,r=t.paragraph,a=t.titleSection,s=void 0;Utility.getCurrentScreenHeight>=1e3?i.addEventListener("scroll",function(){e(7)}):i.addEventListener("scroll",function(){e(4)})}},Paranoia:{getElements:function(){return{article:document.querySelector(".story-2>article"),followLeft:document.querySelectorAll(".follow-left"),followRight:document.querySelectorAll(".follow-right")}},getScrollTop:function(){var e=this.getElements(),t=e.article,n=e.followLeft,i=e.followRight,r=void 0;window.addEventListener("load",function(){i.forEach(function(e){e.classList.add("js-hide")})}),t.addEventListener("scroll",function(){(r=t.scrollTop)<300||r>1800&&r<2499||r>3200?(n.forEach(function(e){e.classList.remove("js-hide")}),i.forEach(function(e){e.classList.add("js-hide")})):(r>300&&r<1799||r>2500&&r<3199)&&(n.forEach(function(e){e.classList.add("js-hide")}),i.forEach(function(e){e.classList.remove("js-hide")}))})}}},onLoad=function(){var e=Utility.getCurrentPath();"index"==e?(IndexPage.getReadingList("readingList"),IndexPage.setFormListeners(),Navigation.getLoginOrSignup("index")):"searchResults"==e?(LoadStories.createRequest("input"),Navigation.getLoginOrSignup("searchResults")):"signUp"==e?(SignUpPage.Constraint.checkElements(),SignUpPage.Constraint.setCurrentDate(),SignUpPage.UserActions.init()):"kater"==e?StoryPage.Kater.handleScroll():"paranoia"==e&&StoryPage.Paranoia.getScrollTop()}();